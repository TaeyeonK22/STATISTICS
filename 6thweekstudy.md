# 통계학 6주차 정규과제

📌통계학 정규과제는 매주 정해진 분량의 『*데이터 분석가가 반드시 알아야 할 모든 것*』 을 읽고 학습하는 것입니다. 이번 주는 아래의 **Statistics_6th_TIL**에 나열된 분량을 읽고 `학습 목표`에 맞게 공부하시면 됩니다.

아래의 문제를 풀어보며 학습 내용을 점검하세요. 문제를 해결하는 과정에서 개념을 스스로 정리하고, 필요한 경우 추가자료와 교재를 다시 참고하여 보완하는 것이 좋습니다.

6주차는 `3부. 데이터 분석하기`를 읽고 새롭게 배운 내용을 정리해주시면 됩니다.


## Statistics_6th_TIL

### 3부. 데이터 분석하기
### 12.통계 기반 분석 방법론



## Study Schedule

|주차 | 공부 범위     | 완료 여부 |
|----|----------------|----------|
|1주차| 1부 p.2~56     | ✅      |
|2주차| 1부 p.57~79    | ✅      | 
|3주차| 2부 p.82~120   | ✅      | 
|4주차| 2부 p.121~202  | ✅      | 
|5주차| 2부 p.203~254  | ✅      | 
|6주차| 3부 p.300~356  | ✅      | 
|7주차| 3부 p.357~615  | 🍽️      |

<!-- 여기까진 그대로 둬 주세요-->

# 12.통계 기반 분석 방법론

```
✅ 학습 목표 :
* 주성분 분석(PCA)의 개념을 설명할 수 있다.
* 다중공선성을 진단할 수 있다.
* Z-TEST와 T-TEST의 개념을 비교하고, 적절한 상황에서 검정을 설계하고 수행할 수 있다.
* ANOVA TEST를 활용하여 세 개 이상의 그룹 간 평균 차이를 검정하고, 사후검정을 수행할 수 있다.
* 카이제곱 검정을 통해 범주형 변수 간의 독립성과 연관성을 분석하는 방법을 설명할 수 있다.
```

## 12.1. 분석 모델 개요
- 주요 데이터 분석 방법론
  - 통계 모델(Statistical Models)<br>: 통계학에 기반
  - 기계 학습(Machine Learning)<br>: 인공지능에서 파생
  - 차이점
    - 통계 모델은 모형과 해석을 중요하게 생각하며, 오차와 불확정성을 강조한다.
    - 기계 학습은 대용량 데이터를 활용하여 예측의 정확도를 높이는 것을 중요하게 생각한다. 
  - 최근 기업에서는 머신러닝 방법에 주로 관심을 가지고 있고 활용도도 높은 것이 사실이지만, 기계학습도 기본적으로는 통계모델의 원리에 기반하고 있으므로 대표적인 통계모델 방법론을 제대로 익히는 것이 좋다.

- 기계 학습 데이터 분석 방법론
  - 종속변수의 유무: 지도학습, 비지도학습, 강화학습
  - 독립변수와 종속변수의 속성(양적, 질적 변수 형태에 따른)

- 종속변수의 유무에 따른 기계 학습 방법론
  - 지도학습<br>: 입력에 대한 정답이 주어져서 출력된 결과값과 정답 사이의 오차가 줄어들도록 학습과 모델 수정을 반복한다. 결과값이 양적 척도면 회귀(Regression)의 방법론을 사용하고, 결괏값이 질적척도면 분류(Classification) 방식의 방법론을 사용한다.
  - 비지도학습<br>: 별도의 정답이 없어 변수 간의 패턴을 파악하거나 뎅터를 군집화하는 방법이다. 크게 차원 축소, 군집 분석, 연관 규칙이라는 세 가지로 구분 지을 수 있다.
    - 차원 축소<br>: 주로 **지도학습**을 할 때 학습 성능을 높이기 위한 전처리 방법으로 사용도는 경우가 많으며 통계 모델과 유사한 성격을 가지고 있다.
    - 군집 분석<br>: 정답지 없이 유사한 관측치들끼리 군집으로 분류하는 기법이다. 유사한 특성을 가진 것끼리 묶음으로써 각 집단의 특성을 분석한다. 대표적인 예로 고객 세분화(customer segmentation)이 있다.
    - 연관규칙<br>: 각 소비자의 구매 리스트를 통해 제품 간의 연관성을 수치화하여, 앞으로 구매할 가능성이 높은 제품을 추천할 수 있도록 하는 방법론이다.
  - 강화학습<br>: 동물이 시행착오를 통해 학습하는 과정을 기본 콘셉트로 한 방법론 중 하나이다. A버튼과 B버튼이 있다면 처음에 원숭이는 아무 버튼이나 누를 것이다. 하지만 얼마 안 되어 먹이를 주는 A 버튼만 누르게 되는데, 이처럼 모델의 결과에 보상과 벌을 주어서 스스로 학습하게 하는 것이 강화 학습이다. 알파고가 강화학습 알고리즘을 사용한 대표적인 예라 할 수 있다.

## 12.2. 주성분 분석(PCA)
- 개요
  - 주성분 분석은 여러 개의 독립변수들을 잘 설명해 줄 수 있는 주된 성분을 추출하는 기법이다. 주성분 분석을 통해 전체 변수들의 핵심 성분만 선별하기 때문에, 독립변수(차원)의 수를 줄일 수 있다. 이는 흔히 말하는 차원의 저주를 방지하기 위한 방법이다. 
  - 차원을 감소하는 방법은 크게 두 가지로 구분할 수 있다.
    - 첫째, 변수 선택을 통해 비교적 불필요하거나 유의성이 낮은 변수를 제거하는 방법
    - 둘째, 변수들의 잠재적인 성분을 추출하여 차원을 줄이는 방법
  - 주성분 분석(PCA)와 공통요인분석(CFA)는 두 번째 방법에 속한다.
  - PCA는 변수의 수를 축약하면서 정보의 수를 최소화하고자 할 때 사용되며, CFA는 변수들 사이에 존재하는 차원을 규명함으로써 변수들 간의 구조를 파악하는 데 주로 사용된다.

- PCA 방법
  - PCA는 데이터 공간에 위치하는 점들의 분산을 최대한 보존하는 축을 통해 차원을 축소하는 것이 핵심 요소이다.
  - PCA과정에서는 처음 가지고 있던 변수의 개수만큼 새로운 성분변수가 생성된다.
  - 하지만 설명력이 높은 순서대로 성분변수가 생성되기 때문에, 일반적으로는 제 1주성분, 제2주성분만으로 대부분의 설명력이 포함되기 때문에 두 개의 주성분만 선정한다.

- 주성분의 설명력
  - 전체 분산 중에서 해당 주성분이 갖고 있는 분산이 곧 설명력이라 할 수 있다.
  - 제 1주성분의 분산이 만약 15이고, 제 2주성분의 분산이 5라고 가정하면, 제 1주성분의 설명력은 전체 분산인 20 중 15이므로 75%이다. 그리고 제 2주성분은 나머지인 25%의 설명력을 갖게 된다.

## 12.4. 다중공선성 해결과 섀플리 밸류 분석
### 다중공선성 해결결
- 개요
  - 다중공선성이란?<br>: 독립변수들 간의 상관관계가 높은 현상을 뜻한다. 즉 두 개 이상의 독립변수가 서로 선형적인 관계를 나타낼 때 다중공선성이 있따고 말한다. 이렇게 되면 독립 변수들 간에는 서로 독립이라는 회귀분석의 전제 가정을 위반하게 된다.

- 다중공선성을 판별하는 기준
  - 회귀분석 모델 실행 전<br>: 상관분석을 통해 독립 변수 간의 상관성을 확인하여 높은 상관계수를 가진 독립변수를 찾아내는 방법.하지만 이 방법은 변수가 많을 경우 상관성을 파악하기 힘들다는 단점이 있다.
  - 회귀분석 결과에서<br>: 독립변수들의 설명력을 의미하는 결정계수 R<sup>2</sup> 값은 크지만 회귀계수에 대한 t값<sup>*</sup>(t-value)이 낮다면 다중공선성을 의심해 볼 수 있다.<br>종속변수에 대한 독립변수들의 설명력은 높지만 각 계수 추정치의 표준오차가 크다는 것은 독립변수 간에 상관성이 크다는 것을 의미하기 때문이다. t값은 유의확률 0.05수준(95% 수준)에서 t값이 &plusmn;1.96 이상이면 적절한 것으로 판단한다.
  - VIF(Variance Inflation Factor)<br>: 분산팽창계수, VIF를 통해 다중공선성을 판단할 수 있다. VIF 값은 회귀분석 모델에 사용된 다른 독립 변수들이 해당 변수 대신 모델을 설명해 줄 수 있는 정도를 나타낸다. 따라서 VIF가 크다는 것은 해당 변수가 다른 변수들과 상관성이 높다는 것이기 때문에 회귀 계수에 대한 분산을 증가시키므로 제거를 해주는 것이 좋다.

- 다중공선성을 해결하는 방법
  1. VIF 값이 가장 높으면서 종속변수와의 상관성(설명력)이 가장 낮은 변수 제거<br>: 기본적인 방법으로, VIF값이 높은 변수들 중에서 종속변수와의 상관성(설명력)이 가장 낮은 변수를 제거하고 다시 VIF값을 확인하는 것을 반복하는 것이다.
  2. 표본 관측치를 추가적으로 확보<<br>: 이는 현실적으로 어려운 방법이기 때문에 잘 쓰이지 않는다.
  3. 로그, 표준화 등을 통한 변수 가공<br>: 현실성을 고려하면, 변수를 가공하여 변수 간의 상관성을 줄이는 방법이 유용하게 사용될 수 있다. 해당 값에 로그를 취하거나, 표준화 및 정규화 변환을 해 주면 다른 변수와의 높았던 상관성이 완화될 수 있다. 아니면 연속형 변수를 구간화 혹은 명목변수로 변환할 수도 있다. 정보의 손실이 발생하긴 하지만 다중공선성 때문에 변수가 제거되는 것보다는 나은 선택이 될 수 있다.
  4. 주성분분석을 통한 변수 축약<br>: 앞에서 다뤘던 주성분분석을 통해서도 다중공선성을 해결할 수 있다. 하지만 주성분분석을 이용하면 변수의 해석이 어려워진다는 점을 염두에 두어야 한다.
  5. 변수 선택 알고리즘을 활용하여 적정 변수 자동 선정<br>: 데이터 분석 환경에서 제공하는 변수 선택 알고리즘을 활용하는 방법이 있다. 보통 전진 선택법, 후진 제거법, 단계적 선택법 중 하나를 선택하여 특정 로직에 의해 모형에 적합한 변수를 자동으로 선정한다. 

### 섀플리 밸류
- 개요
  - 각 독립변수가 종속변수의 설명력에 기여하는 순수한 수치를 계산하는 방법이다. 즉, 독립변수의 설명력 분배 방법이다.
  - 섀플리 밸류는 해당 변수를 모델에 투입했을 때 설명력에 어느 정도 기여를 하는지 측정할 수 있는 기준값으로 활용할 수 있다.

## 12.6. Z-test와 T-test
- 개요
  - Z-test와 T-test, Anova는 통계 기반 데이터 분석의 기본 방법론 중 하나이다. 집단 내 혹은 집단 간의 평균값 차이가 통계적으로 유의미한 것인지 알아내는 방법이다. 
  - 예를 들어, 두 집단의 평균에 차이가 있을 때, 우연한 차이인지, 통계적으로 유의미한 차이인지를 알아보려면 위 세 가지 방법을 사용하면 된다.
  - Z-test와 T-test는 두 집단 간의 평균 차이를 분석할 때 사용하는 것이고, Anova는 두 집단 이상일 경우에 사용한다.

- Z-test와 T-test 비교
  - 공통점
    - 단일 표본 집단의 평균 변화를 분석하거나 두 집단의 평균값 혹은 비율 차이를 분석할 때 사용한다. 
    - 분석하고자 하는 변수가 양적 변수이고, 정규 분포이며, 등분산이라는 조건이 충족되어야 한다. 
    - barlett 등분산성 검정을 통해 확인할 수 있으며, 등분산을 만족하면 equal variance t-test를 수행하고 만족하지 않으면 Welch's t-test를 수행한다. 
  - Z test와 T-test 중 분석 방법의 선택 기준
    - Z-test<br>: 모집단의 분산을 알 수 있는 경우에 사용. 이러한 경우는 거의 없지만, 표본이 30 이상이면 중심극한정리에 의해 표본 정규분포가 정규분포를 따른다고 보아 Z-test 사용 가능하다.
    - T-test<br>: 표본의 크기가 30 미만이어서 표본 집단의 정규분포를 가정할 수 없을 때 사용된다. 물론 표본 크기가 30 이상일 때도 사용 가능하기 때문에 일반적으로 T-test를 사용한다.

## 12.7. ANOVA
- Anova를 사용하는 이유<br>: T-test, Z-test는 두 집단 간의 차이를 검정하는 방법이다. 세 집단 이상의 평균 차이도 검정할 수 는 있지만, 두 집단 간의 차이 검정을 여러 번 수행하는 방식으로 진행되기 때문에 이는 신뢰도가 하락하는 문제가 발생한다. 

- 개요
  - ANOVA(Analysis of Variance)는 분산 분석이이라고도 불린다.
  - T 분포를 사용하는 T-test와는 달리 F분포를 사용한다. F검정의 통계값은 집단 간 분산의 비율을 나타낸다. 그래서 분산 분석이라고 불리는 것이다.

- F분포 및 회귀분석과의 관련성
  - 연속확률분포인 F분포는 두 모분산의 비교 및 검정을 위해 사용된다. 항상 양의 값을 가지며 오른쪽으로 긴 꼬리 형태를 보인다. ANOVA나 회귀분석 등에서 F분포를 통해 독립변수가 종속변수에 미치는 영향을 분석한다.
  - ANOVA도 결국에는 집단의 종류(독립변수)가 평균 값의 차이 여부(종속변수)에 미치는 영향을 검정하는 것이다. 이러한 점에서 ANOVA는 회귀분석과 비슷한 면이 있다.

- ANOVA의 명칭<br>: 독립변수인 요인의 수에 따라서 다르게 불린다.
    - 일원 분사분석: 평균 차이를 비교하기 위한 요인이 하나인 경우
    - 이원 분산분석: &#12291; 요인이 두 가지인 경우
    - N원 분산분석: &#12291; N &#12291;

- 독립변수의 조건
  - 독립변수는 집단을 나타낼 수 있는 범주형 변수이어야 한다.
  - 종속변수는 연속형 변수이어야 한다. 
  - 독립변수와 종속변수가 연속형이면 회귀분석으로, 독립변수와 종속변수가 범주형인 경우에는 교차분석으로 각각 분석 방법이 바뀐다.

- 활용 요소
  - ANOVA는 각 집단의 평균값 차이가 통계적으로 유의한지 검증한다.
  - 따라서 각 집단의 평균이 서로 멀리 떨어져 있어 집단 평균의 분산이 큰 정도를 따져서 집단 간 평균이 다른지를 판별한다
  - 이러한 요소로 집단 내 분산과 집단 간 평균의 분산이 사용된다.
  - 예시(ANOVA의 원리)
    - 집단 3개가 있다고 할 때, 집단 간 관측치의 값이 겹치는 부분이 크면 각 집단의 평균이 다르다고 보기 어려울 것이다.
    - 반면에 각 집단의 평균이 멀리 떨어져 있으면 집단 간 평균 차이가 확실히 난다고 할 수 있을 것이다.
  - 큰 개념으로, 집단 간 평균의 분산을 집단 내 분산으로 나눈 값이 유의도 임계치를 초과하는가에 따라 집단 간 평균 차이를 검정한다. 

- 사후 검증
  - 결과만으로는 각 집단의 평균이 모두 다른것인지 확인하기 어려울 때, 즉 1종 오류를 방지하기 위해 사후 검증을 한다. 
  - 사후 검증은 독립변수 수준 사이에서 평균의 차이를 알고자 할 때 쓰이는 기법이다. 사후검증 방법으로는 Turkey의 `HSD 검증`, 집단의 수가 다를 때 사용하는 `Scheffe 검증`방법 등이 있다. 

## 12.8. 카이제곱 검정(교차분석)
- 카이제곱 검정의 필요성
  - 공분산과 상관성 분석은 등간이나 비율척도로 이루어진 연속형 변수 간의 연관성을 측정하는 분석 방법이었다. 
  - 카이제곱 검정은 명목 혹은 서열척도와 같은 범주형 변수들 간의 연관성을 분석하기 위해 결합분포를 활용하는 방법이다.
  - '연령'과 같은 비율척도 변수는 '연령대'와 같은 서열척도로 변환해서 사용해야 한다.

- 개요
  - 기본 원리는 변수들 간의 범주를 동시에 교차하는 교차표를 만들어 각각의 빈도와 비율을 통해 변수 상호 간의 독립성과 관련성을 분석하는 것이다. 
  - 교차분석은 상관분석과는 달리 연관성의 정도를 수치로 표현할 수 없다.
  - 대신 검정 통계랑 카이 제곱(X<sup>2</sup>)을 통해 변수 간에 연관성이 없다는 귀무가설을 기각하는지 여부로 상관성이 있고 없음을 판단한다.

- 과정
  1. 우선 명목척도로 이루어진 두 개의 변수를 교차표로 표현한다.
  2. 다음으로 두 변수가 서로 독립적일 경우에 나타날 기대빈도를 구한다.<br>&nbsp; 실제 관측빈도와 기대빈도와의 차이를 통해 상호독립성이나 관련성을 분석하는 것이다.
  3. 검정 통계량 X<sup>2</sup>을 산출하여 유의수준에 따라 결정된 임계치를 비교하여 가설을 검정한다.<br>&nbsp;검정통계량은 각 셀의 X<sup>2</sup><sub>ij</sub>값을 구한 다음 모두 합하면 된다.

<br>
<br>

# 확인 문제

### **문제 1.**
> **🧚 경희는 다트비 교육 연구소의 연구원이다. 경희는 이번에 새롭게 개발한 교육 프로그램이 기존 프로그램보다 학습 성취도 향상에 효과적인지 검증하고자 100명의 학생을 무작위로 두 그룹으로 나누어 한 그룹(A)은 새로운 교육 프로그램을, 다른 그룹(B)은 기존 교육 프로그램을 수강하도록 하였다. 실험을 시작하기 전, 두 그룹(A, B)의 초기 시험 점수 평균을 비교한 결과, 유의미한 차이가 없었다. 8주 후, 학생들의 최종 시험 점수를 수집하여 두 그룹 간 평균 점수를 비교하려고 한다.**   

> **🔍 Q1. 이 실험에서 사용할 적절한 검정 방법은 무엇인가요?**

```
T-test와 Z-test 모두 활용될 수 있다.
이유: 각 그룹의 인원이 50명을 넘어, Z-test를 활용하더라도 중심극한정리가 성립하기 때문이다.
```

> **🔍 Q2. 이 실험에서 설정해야 할 귀무가설과 대립가설을 각각 작성하세요.**

```
귀무가설: 8주 후 A그룹과 B그룹 간의 시험 점수 평균은 차이가 없다.
대립가설: 8주 후 A그룹과 B그룹 간의 시험 점수 평균은 차이가 있다.
```

> **🔍 Q3. 검정을 수행하기 위한 절차를 순서대로 서술하세요.**

<!--P.337의 실습 코드 흐름을 확인하여 데이터를 불러온 후부터 어떤 절차로 검정을 수행해야 하는지 고민해보세요.-->

```
1. 표본의 개수를 확인하여 Z-test와 T-test 중 어떤 것을 활용할 수 있는지 판단한다.
2. 칼럼별 차이를 확인하기 위하여 시각화 방법을 활용한다.
3. Z-test(T-test)를 하기에 앞서 데이터 정규성 검정을 수행한다.
4. 등분산성 검정을 수행한다.
5. Z-test(T-test)를 수행한다. p-value를 통해 검정 결과를 확인한다.
```

> **🔍 Q4. 이 검정을 수행할 때 가정해야 하는 통계적 조건을 설명하세요.**

```
분석하고자 하는 변수가 양적 변수이고, 정규 분포이며, 등분산이라는 조건이 충족되어야 한다
```

> **🔍 Q5. 추가적으로 최신 AI 기반 교육 프로그램(C)도 도입하여 기존 프로그램(B) 및 새로운 프로그램(A)과 비교하여 성취도 차이가 있는지 평가하고자 한다면 어떤 검정 방법을 사용해야 하나요? 단, 실험을 시작하기 전, C 그룹의 초기 점수 평균도 A, B 그룹과 유의미한 차이가 없었다고 가정한다.**

```
ANOVA 검정 방법을 활용한다.
이유: 3개 이상의 집단을 비교하는 경우, Z-test(T-test)를 활용하면 신뢰도에 문제가 생길 수 있기 때문이다.
```

> **🔍 Q6. 5번에서 답한 검정을 수행한 결과, 유의미한 차이가 나타났다면 추가적으로 어떤 검정을 수행해 볼 수 있을까요?**

```
사후 검정을 수행한다. (HSD, Scheffe 검증 등)
```

## ✅ \[3단계] ANOVA 결과 유의미한 차이가 나타난 경우 → 다음에 해야 할 것?

### 🔍 왜 추가 검정이 필요한가?

* ANOVA는 **"어디에서 차이가 나는지는 말해주지 않음"**
  즉, A-B가 다른 건지, A-C가 다른 건지, B-C가 다른 건지 알 수 없음

### 👉 필요한 추가 검정:

* **사후검정(Post-hoc test)** 수행 필요

### 📌 대표적인 사후검정 종류:

| 검정명            | 설명                               |
| -------------- | -------------------------------- |
| **Tukey의 HSD** | 그룹 간 모든 쌍을 비교하며, Type I error 제어 |
| Bonferroni     | 보수적, 유의수준을 나눠서 비교                |
| Scheffé        | 보수적인 해석, 표본 수 다를 때도 가능           |
| Duncan         | 비교적 덜 보수적 (Type I error 높을 수 있음) |

### ✅ 결론:

> **사후검정(Post-hoc test)** 을 통해 어떤 그룹 간 차이가 유의미한지 구체적으로 분석해야 함
> 가장 흔히 쓰이는 방식은 **Tukey’s HSD test**


### **문제 2. 카이제곱 검정**  
> **🧚 다음 중 어떠한 경우에 카이제곱 검정을 사용해야 하나요?   
1️⃣ 제품 A, B, C의 평균 매출 차이를 비교하고자 한다.  
2️⃣ 남성과 여성의 신체 건강 점수 평균 차이를 분석한다.  
3️⃣ 제품 구매 여부(구매/미구매)와 고객의 연령대(10대, 20대, 30대…) 간의 연관성을 분석한다.  
4️⃣ 특정 치료법이 환자의 혈압을 감소시키는 효과가 있는지 확인한다.**  

```
3️⃣
이유: 카이제곱 검정은 범주형 변수 간의 연관성을 분석하는 검정방법이기 때문이다.
```

### 🎉 수고하셨습니다.